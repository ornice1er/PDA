<div class="flex flex-col gap-y-8 w-full">
  <div class="flex items-center justify-between">
    <div>
      <h2 class="text-3xl font-semibold text-dark-900 mb-2 text-balance">Tableau de Bord</h2>
      <p class="text-gray-500">Vue d'ensemble de votre espace administratif</p>
    </div>
    <div class="flex flex-col items-center space-x-2 text-sm text-gray-400 bg-gray-50 px-4 py-2 rounded-xl">
      <p-calendar appendTo="body" dateFormat="dd/mm/yy" [maxDate]="endDate" [(ngModel)]="selectedDate"
        (onSelect)="onDateselected($event)" placeholder="Selectionnez une date" [iconDisplay]="'input'"
        [showIcon]="true" inputId="templatedisplay">
        <ng-template pTemplate="inputicon" let-clickCallBack="clickCallBack">
          <span class="p-element p-icon-wrapper p-datepicker-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="size-4 text-gray-400 pointer-events-none"
              (click)="clickCallBack($event)" viewBox="0 0 24 24">
              <g fill="none">
                <path stroke="currentColor" stroke-width="1.5"
                  d="M2 12c0-3.771 0-5.657 1.172-6.828S6.229 4 10 4h4c3.771 0 5.657 0 6.828 1.172S22 8.229 22 12v2c0 3.771 0 5.657-1.172 6.828S17.771 22 14 22h-4c-3.771 0-5.657 0-6.828-1.172S2 17.771 2 14z" />
                <path stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M7 4V2.5M17 4V2.5M2.5 9h19" />
                <path fill="currentColor"
                  d="M18 17a1 1 0 1 1-2 0a1 1 0 0 1 2 0m0-4a1 1 0 1 1-2 0a1 1 0 0 1 2 0m-5 4a1 1 0 1 1-2 0a1 1 0 0 1 2 0m0-4a1 1 0 1 1-2 0a1 1 0 0 1 2 0m-5 4a1 1 0 1 1-2 0a1 1 0 0 1 2 0m0-4a1 1 0 1 1-2 0a1 1 0 0 1 2 0" />
              </g>
            </svg>
          </span>
        </ng-template>
      </p-calendar>
    </div>

  </div>
  <div *ngIf="loading" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
    <p-skeleton *ngFor="let item of [1,2,3,4]" height="14rem" class="w-full" borderRadius="16px" />
  </div>
  <!-- Stats Cards -->
  <div *ngIf="!loading" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 2xl:grid-cols-4 gap-6">
    <div
      class="bg-white rounded-3xl shadow-sm border border-gray-100 p-8 hover:shadow-lg hover:-translate-y-1 transition-all duration-300 animate-in slide-in-from-bottom">
      <div class="flex items-start justify-between mb-6">
        <div class="bg-green-light/20 p-4 rounded-2xl">
          <lucide-icon [img]="usersIcon" size="24" class="text-green-light"></lucide-icon>
        </div>
      </div>
      <div>
        <p class="text-sm font-medium text-gray-500 mb-2">{{ 'Nb de visites enregistrées' }}</p>
        <p class="text-1xl 2xl:text-3xl font-bold text-dark-900">{{ data.countVisit }}</p>
      </div>
    </div>
    <div
      class="bg-white rounded-3xl shadow-sm border border-gray-100 p-8 hover:shadow-lg hover:-translate-y-1 transition-all duration-300 animate-in slide-in-from-bottom">
      <div class="flex items-start justify-between mb-6">
        <div class="bg-primary-dark/20 p-4 rounded-2xl">
          <lucide-icon [img]="userCheckIcon" size="24" class="text-primary-dark"></lucide-icon>
        </div>
      </div>
      <div>
        <p class="text-sm font-medium text-gray-500 mb-2">{{ 'Nb de visites satisfait' }}</p>
        <p class="text-3xl font-bold text-dark-900">{{ data.countVisitSatisfait }}</p>
      </div>
    </div>
    <div
      class="bg-white rounded-3xl shadow-sm border border-gray-100 p-8 hover:shadow-lg hover:-translate-y-1 transition-all duration-300 animate-in slide-in-from-bottom">
      <div class="flex items-start justify-between mb-6">
        <div class="bg-primary/25 p-4 rounded-2xl">
          <lucide-icon [img]="alertTriangleIcon" size="24" class="text-primary"></lucide-icon>
        </div>
      </div>
      <div>
        <p class="text-sm font-medium text-gray-500 mb-2">{{ 'Nb de requêtes enregistré' }}</p>
        <p class="text-3xl font-bold text-dark-900">{{ data.countReq }}</p>
      </div>
    </div>
    <div
      class="bg-white rounded-3xl shadow-sm border border-gray-100 p-8 hover:shadow-lg hover:-translate-y-1 transition-all duration-300 animate-in slide-in-from-bottom">
      <div class="flex items-start justify-between mb-6">
        <div class="bg-orange-600/25 p-4 rounded-2xl">
          <lucide-icon [img]="megaphoneIcon" size="24" class="text-orange-600"></lucide-icon>
        </div>
      </div>
      <div>
        <p class="text-sm font-medium text-gray-500 mb-2">{{ 'Nb de requêtes traitées' }}</p>
        <p class="text-3xl font-bold text-dark-900">{{ data.countReqTraite }}</p>
      </div>
    </div>
  </div>
  <div *ngIf="!loading" class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <div class="bg-white rounded-3xl shadow-sm border border-gray-100 p-8 animate-in">
      <h3 class="text-base lg:text-lg 2xl:text-xl font-medium text-dark-900 mb-6">Évolution des visites au cours des 3
        derniers mois</h3>
      <div class="space-y-4">
        <canvas baseChart [data]="lineChartData" [options]="lineChartOptions" [type]="lineChartType"></canvas>
      </div>
    </div>

    <div class="bg-white rounded-3xl shadow-sm border border-gray-100 p-8 animate-in">
      <h3 class="text-base lg:text-lg 2xl:text-xl font-medium text-dark-900 mb-6">Rapports mensuels</h3>
      <div class="space-y-4">
        <section class="w-full flex flex-col justify-center items-start sm:rounded-t-lg overflow-x-auto">
          <table class="min-w-full rounded-t-lg">
            <thead class="bg-primary rounded-t-lg">
              <tr>
                <th scope="col" class="py-3.5 pl-4 sm:pl-10 pr-3 text-start text-sm font-semibold text-white">
                  Date
                </th>
                <th scope="col" class="py-3.5 pl-4 sm:pl-10 pr-3 text-start text-sm font-semibold text-white">
                  Nom du document
                </th>
                <th scope="col" class="px-3 py-3.5 text-center text-sm font-semibold text-white">
                  Actions
                </th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-300 bg-white" *ngIf="reports.length !== 0">
              <tr *ngFor="let document of reports">
                <td
                  class="whitespace-wrap py-2 pl-4 sm:pl-10 pr-3 text-sm font-medium text-start  capitalize text-gray-900">
                  {{ document?.created_at | date:'longDate' }}
                </td>
                <td class="whitespace-wrap py-2 pl-4 sm:pl-10 pr-3 text-sm font-medium text-start text-gray-900">
                  {{ document?.title }}
                </td>
                <td class="relative whitespace-nowrap py-2 pl-3 pr-4 text-center text-sm font-medium sm:pr-6">
                  <div class="flex flex-row items-center justify-center space-x-4">
                    <a [href]="document?.url" target="_blank" class="text-primary bg-primary/20 flex items-center justify-center rounded-full size-8">
                      <span class="sr-only">View</span>
                      <svg xmlns="http://www.w3.org/2000/svg" class="size-5" viewBox="0 0 24 24">
                        <g fill="none" stroke="currentColor" stroke-width="1.5">
                          <path
                            d="M3.275 15.296C2.425 14.192 2 13.639 2 12c0-1.64.425-2.191 1.275-3.296C4.972 6.5 7.818 4 12 4s7.028 2.5 8.725 4.704C21.575 9.81 22 10.361 22 12c0 1.64-.425 2.191-1.275 3.296C19.028 17.5 16.182 20 12 20s-7.028-2.5-8.725-4.704Z" />
                          <path d="M15 12a3 3 0 1 1-6 0a3 3 0 0 1 6 0Z" />
                        </g>
                      </svg>
                    </a>
                  </div>
                </td>
              </tr>
            </tbody>
            <tbody *ngIf="reports.length === 0" class="divide-y divide-gray-300 bg-white">
              <tr>
                <td colspan="10" class="p-4 w-full whitespace-nowrap">
                  <div class="flex justify-center w-full items-center text-gray-800 text-center">
                    <div *ngIf="!loading"
                      class="flex flex-col justify-center w-full items-center text-gray-800 text-center space-y-3">
                      <svg xmlns="http://www.w3.org/2000/svg" class="size-12 text-primary" viewBox="0 0 24 24">
                        <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                          stroke-width="1.5" color="currentColor">
                          <path
                            d="M18 15v7m3.5-3.5h-7M7 16h4m-4-5h8M6.5 3.5c-1.556.047-2.483.22-3.125.862c-.879.88-.879 2.295-.879 5.126v6.506c0 2.832 0 4.247.879 5.127C4.253 22 5.668 22 8.496 22H11.5m3.992-18.5c1.556.047 2.484.22 3.125.862c.88.88.88 2.295.88 5.126V12" />
                          <path
                            d="M6.496 3.75c0-.966.784-1.75 1.75-1.75h5.5a1.75 1.75 0 1 1 0 3.5h-5.5a1.75 1.75 0 0 1-1.75-1.75" />
                        </g>
                      </svg>
                      <p class="font-avenirMedium text-sm">Aucune données</p>

                    </div>
                    <div *ngIf="loading"
                      class="flex flex-col justify-center w-full items-center text-gray-800 text-center space-y-3">
                      <svg xmlns="http://www.w3.org/2000/svg" class="size-12 text-primary" viewBox="0 0 24 24">
                        <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                          stroke-width="1.2">
                          <path stroke-dasharray="16" stroke-dashoffset="16" d="M12 3c4.97 0 9 4.03 9 9">
                            <animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="16;0" />
                            <animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite"
                              type="rotate" values="0 12 12;360 12 12" />
                          </path>
                          <path stroke-dasharray="64" stroke-dashoffset="64" stroke-opacity="0.2"
                            d="M12 3c4.97 0 9 4.03 9 9c0 4.97 -4.03 9 -9 9c-4.97 0 -9 -4.03 -9 -9c0 -4.97 4.03 -9 9 -9Z">
                            <animate fill="freeze" attributeName="stroke-dashoffset" dur="1.2s" values="64;0" />
                          </path>
                        </g>
                      </svg>
                      <p class="font-avenirMedium text-sm">
                        Chargement en cours ...
                      </p>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </section>
      </div>
    </div>
  </div>






</div>
